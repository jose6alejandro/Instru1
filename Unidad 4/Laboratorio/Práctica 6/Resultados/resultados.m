% Práctica 6 - Computador Analógico
% Castro J, Hurtado C.

X1 = importdata('Medidas/salida_x1.CSV',',',18);
X1_Data =  X1.data(:, 4:5);

X2 = importdata('Medidas/salida_x2.CSV',',',18);
X2_Data =  X2.data(:, 4:5);

tiempo = [0 0.0100953175116831 0.0605719050700986 0.113145890630598 0.166521250556407 0.221017097068743 0.276954234293540 0.334716286995750 0.394792990066843 0.457858336937688 0.524837499784293 0.594232074851519 0.666558167339781 0.739495819244244 0.813566342173558 0.889368660158781 0.967494392375983 1.04651573936658 1.12516901796473 1.20466206617001 1.28598727551444 1.37014171370346 1.45832738535891 1.55223761060425 1.65471252477559 1.76248222219426 1.87387531422523 1.98830343831428 2.10745453910139 2.22699601305673 2.34772714805051 2.47322107756255 2.60710435256255 2.75498572616897 2.91782908196347 3.08799576815001 3.26733522034459 3.44870278120735 3.63698092339616 3.83698092339616 4.03698092339616 4.23698092339616 4.43698092339616 4.63698092339616 4.83698092339616 5.03698092339616 5.23698092339616 5.43698092339616 5.63698092339616 5.83698092339616 6.03698092339616 6.23698092339616 6.43698092339616 6.63698092339616 6.83698092339616 7.03698092339616 7.23698092339616 7.43698092339616 7.63698092339616 7.83698092339616 8.03698092339616 8.23698092339616 8.43698092339616 8.63698092339616 8.83698092339616 9.03698092339616 9.23698092339616 9.43698092339615 9.63698092339615 9.83698092339615 10];

X1_Simscape = [0 0.0100428376275247 0.0584309979363495 0.104893725282926 0.147207922622504 0.184881961837684 0.217528207816874 0.244877812989864 0.266765944643878 0.283115144473786 0.293898767541730 0.299021833434909 0.299107708607474 0.295112425248450 0.288168676697403 0.279267668090012 0.269289529288369 0.259271265577944 0.250038339960999 0.241898209513750 0.235060874262037 0.229654933102292 0.225738044321506 0.223307956346987 0.222317652653085 0.222636365820719 0.223878222983590 0.225606679755759 0.227466358699650 0.229103292076805 0.230370688905304 0.231236395252894 0.231703917622752 0.231808070842890 0.231623341740819 0.231302537470808 0.230984822455002 0.230765827431880 0.230658743979619 0.230643756429250 0.230680034730795 0.230726914972825 0.230762488723871 0.230780786480102 0.230785047943724 0.230781540758165 0.230775744700332 0.230770906976913 0.230768158329582 0.230767290752254 0.230767565923467 0.230768260305003 0.230768905036608 0.230769306436986 0.230769460883294 0.230769451405225 0.230769371510137 0.230769287358915 0.230769230142714 0.230769204645031 0.230769202142175 0.230769210830989 0.230769221570650 0.230769229550303 0.230769233554147 0.230769234398749 0.230769233534078 0.230769232197692 0.230769231107444 0.230769230501554 0.230769230329823]; 
X1_Simulink = [0 0.0100428376275247 0.0584309979363495 0.104893725282926 0.147207922622504 0.184881961837684 0.217528207816874 0.244877812989864 0.266765944643878 0.283115144473786 0.293898767541730 0.299021833434909 0.299107708607474 0.295112425248450 0.288168676697403 0.279267668090012 0.269289529288369 0.259271265577944 0.250038339960999 0.241898209513750 0.235060874262037 0.229654933102292 0.225738044321506 0.223307956346987 0.222317652653085 0.222636365820719 0.223878222983590 0.225606679755759 0.227466358699650 0.229103292076805 0.230370688905304 0.231236395252894 0.231703917622753 0.231808070842890 0.231623341740819 0.231302537470809 0.230984822455002 0.230765827431880 0.230658743979619 0.230643756429250 0.230680034730795 0.230726914972826 0.230762488723871 0.230780786480102 0.230785047943724 0.230781540758165 0.230775744700332 0.230770906976913 0.230768158329582 0.230767290752254 0.230767565923467 0.230768260305003 0.230768905036608 0.230769306436986 0.230769460883294 0.230769451405225 0.230769371510137 0.230769287358916 0.230769230142715 0.230769204645032 0.230769202142175 0.230769210830989 0.230769221570650 0.230769229550303 0.230769233554147 0.230769234398749 0.230769233534078 0.230769232197692 0.230769231107444 0.230769230501554 0.230769230329823]; 

X2_Simscape = [0 -0.000251365691609470 -0.00844130383008339 -0.0273071697596819 -0.0545971386410940 -0.0883506902809379 -0.126756420363804 -0.168142813027003 -0.210968358963095 -0.253818991655080 -0.295359516148308 -0.332884156518560 -0.365303944511611 -0.390898754705053 -0.409882202286206 -0.422671176136953 -0.429812826163196 -0.431978652178168 -0.430298323380478 -0.425883330474556 -0.419633721177366 -0.412316854601182 -0.404598612494021 -0.397056980246858 -0.390188093229802 -0.384791624238131 -0.381175221798799 -0.379270697082142 -0.378789127288788 -0.379335362374586 -0.380454176894463 -0.381811328860233 -0.383153208827207 -0.384285979856306 -0.385029292283129 -0.385319294886647 -0.385271882010865 -0.385056812662016 -0.384815135427575 -0.384631005367258 -0.384542904022669 -0.384528158961302 -0.384551434289711 -0.384583816684226 -0.384609190778693 -0.384622716968775 -0.384626281932161 -0.384624148310825 -0.384620185217532 -0.384616758554685 -0.384614747645508 -0.384614062318810 -0.384614207632519 -0.384614676414058 -0.384615129857255 -0.384615420963699 -0.384615539323892 -0.384615539478648 -0.384615486459869 -0.384615427720618 -0.384615386546908 -0.384615367381663 -0.384615364676824 -0.384615370296386 -0.384615377730431 -0.384615383431441 -0.384615386399290 -0.384615387121478 -0.384615386586915 -0.384615385670831 -0.384615385017323];
X2_Simulink = [0 -0.000251365691609470 -0.00844130383008339 -0.0273071697596819 -0.0545971386410940 -0.0883506902809379 -0.126756420363804 -0.168142813027003 -0.210968358963095 -0.253818991655080 -0.295359516148308 -0.332884156518560 -0.365303944511611 -0.390898754705053 -0.409882202286206 -0.422671176136953 -0.429812826163196 -0.431978652178168 -0.430298323380478 -0.425883330474556 -0.419633721177366 -0.412316854601183 -0.404598612494021 -0.397056980246858 -0.390188093229802 -0.384791624238131 -0.381175221798799 -0.379270697082142 -0.378789127288788 -0.379335362374586 -0.380454176894463 -0.381811328860233 -0.383153208827207 -0.384285979856306 -0.385029292283129 -0.385319294886647 -0.385271882010865 -0.385056812662016 -0.384815135427574 -0.384631005367258 -0.384542904022669 -0.384528158961302 -0.384551434289711 -0.384583816684226 -0.384609190778693 -0.384622716968775 -0.384626281932161 -0.384624148310825 -0.384620185217532 -0.384616758554685 -0.384614747645508 -0.384614062318810 -0.384614207632519 -0.384614676414058 -0.384615129857255 -0.384615420963699 -0.384615539323892 -0.384615539478648 -0.384615486459869 -0.384615427720618 -0.384615386546908 -0.384615367381663 -0.384615364676824 -0.384615370296386 -0.384615377730431 -0.384615383431441 -0.384615386399290 -0.384615387121478 -0.384615386586915 -0.384615385670831 -0.384615385017323];

figure(1)
subplot(2, 1, 1);
plot(X1_Data(1:834, 1) - 1.25, X1_Data(1:834, 2) - 0.11,'r', tiempo, X1_Simscape,'b', tiempo, X1_Simulink,'g');
title('Salida X1(t)')
xlabel('Tiempo (seg)')
ylabel('Voltaje (V)')
legend('Experimental', 'Simscape', 'Simulink')
grid on;

subplot(2, 1, 2);
plot(X2_Data(1:820, 1) - 0.77, X2_Data(1:820, 2) - 0.1651,'r', tiempo, X2_Simscape,'b', tiempo, X2_Simulink,'g');
title('Salida X2(t)')
xlabel('Tiempo (seg)')
ylabel('Voltaje (V)')
legend('Experimental','Simscape','Simulink')
grid on;

figure(2);
plot(X1_Simscape, X2_Simscape, '*r');
title('Diagrama de fase')
xlabel('X1')
ylabel('X2')
legend('Simulink')
grid on;

